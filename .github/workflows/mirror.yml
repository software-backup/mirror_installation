# .github/workflows/mirror.yml
name: software-installation同步releases

on:
  schedule:
    - cron: '0 0 */2 * *'
  workflow_dispatch:

jobs:
  template:                    # 步骤模板，不执行
    runs-on: ubuntu-latest     # 随便写，反正不会执行
    if: false                  # 强制跳过
    steps: &mirror-steps       # 在这定义锚点
        - name: 检出代码
          uses: actions/checkout@v4
        - name: 设置 Python
          uses: actions/setup-python@v5
          with:
            python-version: '3.9'
        - name: 安装依赖
          run: |
            python -m pip install --upgrade pip
            pip install requests PyGithub>=1.58
        - name: 打印仓库信息
          run: |
            echo "源仓库 : $SOURCE_REPO"
            echo "目标仓库: $TARGET_REPO"
        - name: 检查更新并同步
          env:
            GITHUB_TOKEN: ${{ secrets.TOKEN }}
            SOURCE_GITHUB_TOKEN: ${{ secrets.TOKEN }}
          run: python mirror_github_releases.py
  
  rustdesk_rustdesk:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      packages: write
    env:
      SOURCE_REPO: "rustdesk/rustdesk"
      TARGET_REPO: "software-installation/mirror_rustdesk"
      TARGET_REPO_NAME: rustdesk
    steps: *mirror-steps

  laurent22_joplin:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      packages: write
    env:
      SOURCE_REPO: "laurent22/joplin"
      TARGET_REPO: "software-installation/mirror_joplin"
      TARGET_REPO_NAME: joplin
    steps: *mirror-steps
  



